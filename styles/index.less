@import "ui-variables";
@import "octicons";


@shadow: 1px 2px 12px fade(black, 12%);
@scrollbar-size: 8px;

atom-context-menu {
  .arrow();
  --size:              @disclosure-arrow-size;
  --margin:            1.5em;
  --min-width:         220px;
  --max-width:         420px;
  --min-height:        140px;
  --max-height:        60vh;
  --border-radius:     4px;
  --border-width:      0;
  --border-color:      lighten(@overlay-background-color, 7%);
  --separator-color:   lighten(@overlay-background-color, 10%);
  --background-color:  lighten(@overlay-background-color, 3%);
  --font-size:         0.82em;

  --spacing-half:    ~"calc(var(--spacing) / 2)";
  --spacing-quarter: ~"calc(var(--spacing) / 4)";

  height:              var(--height, --max-height);
  min-width:           var(--min-width);
  min-height:          var(--min-height);
  max-width:           var(--max-width);
  max-height:          var(--max-height);
  background:          var(--background-color);
  box-shadow:          @shadow;
  padding:             @component-padding / 8;
  display:             flex;
  margin:              0 0 var(--margin) 1em;
  border:              1px solid var(--border-color);
  border-radius:       0 var(--border-radius) var(--border-radius);
  transition-duration: 200ms;
  transition-property: max-height, opacity, padding, margin, border-width;
  flex-direction:      column;
  overflow:            auto;

  context-fragment {
    flex:           1 1;
    height:         auto;
    font-size:      var(--font-size);
    flex-basis:     var(--priority, 1);
    flex-direction: column }

  &::-webkit-scrollbar {
    -webkit-appearance: none;
    width:  @scrollbar-size;
    height: @scrollbar-size }

  &::-webkit-scrollbar-track,
  &::-webkit-scrollbar-corner {
    // background: @scrollbar-track-color;
    background: transparent }

  &::-webkit-scrollbar-thumb {
    border: none;
    border-radius: @scrollbar-size / 2;
    background: @scrollbar-color;
    background-clip: content-box;

    &:active,
    &:hover {
      background: @scrollbar-color-active }}

  .section {
    padding: @component-padding / 1.5 }

  ul {
    list-style: none;
    margin:     0;
    padding:    0 @component-padding 0 0 }

  li {
    justify-content: space-between;
    border-radius:   @component-border-radius;
    transition:     .2s background-color, .2s color;
    line-height:     var(--spacing);
    display:         flex;
    padding:         0 var(--spacing-quarter);
    margin:          0 0 1px 0;
  }

  li:empty {
    margin: var(--spacing-half) 0;
    border-bottom: 1px solid var(--separator-color);
  }

  li:hover {
    transition-duration: .15s;
    background: @background-color-highlight;
    cursor: pointer;
    color: @text-color-highlight;
  }

  li.has-children {
    .octicon('tag');
    flex-direction: row-reverse;
  }

  li.has-children::before {
    display: inline-block;
    margin-right: -@component-padding;
    width: @component-padding;
    text-align: center;
  }

  &.hidden {
    display:  block !important;
    overflow: hidden;
    margin:              0;
    opacity:             0;
    min-height:          0;
    max-height:          0;
    padding-top:         0;
    padding-bottom:      0;
    border-top-width:    0;
    border-bottom-width: 0 }
}


.arrow () {
  &::after,
  &::before {
    content:      '';
    border-width: 0 ~"calc(0.8 * var(--size))" var(--size) 0;
    left:         ~"calc(-0.8 * var(--size) + 2.5px)";
    top:          0;
    // top:          ~"calc(-1 * var(--border-width))";
    display:      block;
    position:     absolute;
    box-sizing:   content-box;
    border-color: transparent var(--border-color);
    border-style: solid;
  }
  &::after {
    border-color: transparent var(--background-color);
  }
  &::before {
    margin: -1px 0 0 -1.5px;

  }
}
